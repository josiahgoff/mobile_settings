// Math helper function for Handlebars
function escapeHtml(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(e).replace(/[&<>"'\/]/g,function(e){return t[e]})}function getHeroCount(){return $(".hero",".tab-pane.active").not(".hidden .hero, .hidden.hero").length}function updateHeroCount(){$(".hero-count",".tab-pane.active").not(".hidden .hero-count, .hidden.hero-count").text(getHeroCount())}function updateUI(){var e=$(".tab-pane.active");$("[data-show-req]").each(function(){var e=0,t=$(this).attr("data-show-req").split(/\s+/);for(var n=0;n<t.length;n++)$('[data-req-name="'+t[n]+'"]').is(":checked")||e++;e>0&&!$(this).hasClass("hidden")?$(this).addClass("hidden"):e===0&&$(this).hasClass("hidden")&&$(this).removeClass("hidden")});$("[data-hide-req]").each(function(){var e=0,t=$(this).attr("data-hide-req").split(/\s+/);for(var n=0;n<t.length;n++)$('[data-req-name="'+t[n]+'"]').is(":checked")||e++;e>0&&$(this).hasClass("hidden")?$(this).removeClass("hidden"):e===0&&!$(this).hasClass("hidden")&&$(this).addClass("hidden")});updateHeroCount();getHeroCount()>2?$(".js-delete-row").show():$(".js-delete-row").hide()}Handlebars.registerHelper("math",function(e,t,n,r){if(arguments.length<4){r=n;n=t;t="+"}e=parseFloat(e);n=parseFloat(n);return{"+":e+n,"-":e-n,"*":e*n,"/":e/n,"%":e%n}[t]});jQuery.fn.isHidden=function(){return $(this).closest(".hidden").length};jQuery.fn.outputCode=function(e){var t=$(this),n=t.find(".code-output"),r={},i=$("#"+e).html(),s=Handlebars.compile(i),o=[],u=[];$(t).find("input:not(.hidden)").not('input[type="radio"]:not(:checked), input[type="radio"]:not(:checked), input[data-output="hero_count"], .hero input').each(function(){if(!$(this).isHidden()){var e={};e.name=$(this).attr("data-output");e.val=escapeHtml($(this).val());o.push(e)}});r.options=o;$(".hero",t).each(function(){if(!$(this).isHidden()){var e={};e.src=$(this).find('[data-output="hero-image"]').val();e.title=$(this).find('[data-output="hero-title"]').val();e.link=$(this).find('[data-output="hero-link"]').val();u.push(e)}});r.heroes=u;$('input[data-output="hero_count"]:not(.hidden)',t).length===0?r.heroCount=u.length:$('input[data-output="hero_count"]:not(.hidden)',t).length>0&&(r.heroCount=$('input[data-output="hero_count"]:not(.hidden)',t).val());n.html($.trim(s(r)))};jQuery.fn.addRow=function(){var e=$(this),t={},n=e.attr("data-template"),r=$("#"+n).html(),i=Handlebars.compile(r);e.append(i(t));e.find(".row:last-child").slideDown("400",function(){updateUI()})};$(document).ready(function(){$(".nav-tabs a").click(function(e){e.preventDefault();$(this).tab("show")});$(".js-add-row").each(function(){$(this).addRow()});$('[data-output="hero-repeaters"]').delegate(".js-delete-row","click",function(e){$(this).closest(".row").slideUp(400,function(){$(this).remove();updateUI()})});$(".js-add-row-trigger").click(function(e){var t=$(this).attr("data-target"),n=$("#"+t);n.addRow()});$(".js-convert-trigger").click(function(e){var t=$(this).closest(".tab-pane"),n=$(this).attr("data-output-template");t.outputCode(n)});$(".js-update-ui").click(function(){updateUI()});updateUI()});