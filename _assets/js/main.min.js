// Math helper function for Handlebars
function countHeroes(e){var t=$(".hero",e).not(".hidden .hero, .hidden.hero").length;return t}function updateHeroCount(e,t){$(".hero-count",t).not(".hidden .hero-count, .hidden.hero-count").text(e)}function updateUI(){var e=$(".tab-pane.active");$("[data-show-req]").each(function(){var e=0,t=$(this).attr("data-show-req").split(/\s+/);for(var n=0;n<t.length;n++)$('[data-req-name="'+t[n]+'"]').is(":checked")||e++;e>0&&!$(this).hasClass("hidden")?$(this).addClass("hidden"):e===0&&$(this).hasClass("hidden")&&$(this).removeClass("hidden")});$("[data-hide-req]").each(function(){var e=0,t=$(this).attr("data-hide-req").split(/\s+/);for(var n=0;n<t.length;n++)$('[data-req-name="'+t[n]+'"]').is(":checked")||e++;e>0&&$(this).hasClass("hidden")?$(this).removeClass("hidden"):e===0&&!$(this).hasClass("hidden")&&$(this).addClass("hidden")});updateHeroCount(countHeroes(e),e)}Handlebars.registerHelper("math",function(e,t,n,r){if(arguments.length<4){r=n;n=t;t="+"}e=parseFloat(e);n=parseFloat(n);return{"+":e+n,"-":e-n,"*":e*n,"/":e/n,"%":e%n}[t]});jQuery.fn.isHidden=function(){return $(this).closest(".hidden").length};jQuery.fn.outputCode=function(){var e=$(this),t=e.find(".code-output"),n={},r=$("#code-output-template").html(),i=Handlebars.compile(r),s=[],o=[];$(".js-form-group",e).find("input:not(.hidden)").not('input:not(:checked), input[data-output="hero_count"]').each(function(){if(!$(this).isHidden()){var e={};e.name=$(this).attr("data-output");e.val=$(this).val();s.push(e)}});n.options=s;$(".hero",e).each(function(){if(!$(this).isHidden()){var e={};e.src=$(this).find('[data-output="hero-image"]').val();e.title=$(this).find('[data-output="hero-title"]').val();e.link=$(this).find('[data-output="hero-link"]').val();o.push(e)}});n.heroes=o;$('input[data-output="hero_count"]:not(.hidden)',e).length===0?n.heroCount=o.length:$('input[data-output="hero_count"]:not(.hidden)',e).length>0&&(n.heroCount=$('input[data-output="hero_count"]:not(.hidden)',e).val());t.html($.trim(i(n)))};jQuery.fn.addRow=function(){var e=$(this),t={},n=e.attr("data-template"),r=$("#"+n).html(),i=Handlebars.compile(r);e.append(i(t))};$(document).ready(function(){$(".nav-tabs a").click(function(e){e.preventDefault();$(this).tab("show")});$(".js-add-row").each(function(){$(this).addRow()});$('[data-output="hero-repeaters"]').delegate(".js-delete-row","click",function(e){$(this).closest(".row").remove();updateUI()});$(".js-add-row-trigger").click(function(e){var t=$(this).attr("data-target"),n=$("#"+t);n.addRow();updateUI()});$(".js-convert-trigger").click(function(e){var t=$(this).closest(".tab-pane");t.outputCode()});$(".js-update-ui").click(function(){updateUI()});updateUI()});